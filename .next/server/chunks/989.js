"use strict";exports.id=989,exports.ids=[989],exports.modules={6249:(e,t)=>{Object.defineProperty(t,"l",{enumerable:!0,get:function(){return function e(t,i){return i in t?t[i]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,i)):"function"==typeof t&&"default"===i?t:void 0}}})},3597:(e,t,i)=>{i.a(e,async(e,r)=>{try{i.d(t,{_:()=>n});var a=i(5583),o=i(8950),s=e([o]);o=(s.then?(await s)():s)[0];class n{constructor(){this.monthlyBiases=new Map,this.activeSetups=new Map,this.brokerConfig=null,this.technicalAnalysis=new a.X,this.brokerAPIs=o.p}setBrokerConfig(e){this.brokerConfig=e}async determineMonthlyBias(e){let t=(await this.brokerAPIs.getHistoricalData(e,"1M",60)).slice(-36),i=this.findImpulsiveMovement(t),r=this.identifyMonthlyZones(t);if(!this.brokerConfig)throw Error("Broker config not set");let a=await this.brokerAPIs.getCurrentPrice(this.brokerConfig,e),o="potentially_reversing",s=r.buyZones.some(e=>a>=e.low&&a<=e.high),n=r.sellZones.some(e=>a>=e.low&&a<=e.high);s?o="potentially_reversing":n?o="potentially_reversing":"up"!==i.direction||n?"down"!==i.direction||s||(o="bearish"):o="bullish";let l={instrument:e,bias:o,lastUpdate:Date.now(),zones:r};return this.monthlyBiases.set(e,l),l}async findValidFootprints(e,t,i=100){let r=await this.brokerAPIs.getHistoricalData(e,t,i),a=[];for(let e=5;e<r.length-5;e++){let i=r[e],o=r.slice(e-5,e),s=r.slice(e+1,e+6);if(this.isBullishFootprint(i,o,s)){let i=this.createFootprint(r,e,"bullish",t);i.isValid&&a.push(i)}if(this.isBearishFootprint(i,o,s)){let i=this.createFootprint(r,e,"bearish",t);i.isValid&&a.push(i)}}return a}createFootprint(e,t,i,r){let a=e[t];e.slice(0,t);let o=a.low,s="bullish"===i?a.close:a.open,n=this.countBrokenSwingPoints(e,t,i),l=a.volume||0;return{id:`${r}_${i}_${t}_${Date.now()}`,instrument:e[0].instrument||"unknown",timeframe:r,origin:{low:o,base:s,timestamp:a.timestamp},range:{floor:o,base:s},strength:n,direction:i,volume:l,isValid:n>=1}}isBullishFootprint(e,t,i){let r=e.close-e.open,a=e.high-e.low;if(r/a<.6)return!1;let o=t.map(e=>e.high);return e.close>Math.max(...o)}isBearishFootprint(e,t,i){let r=e.open-e.close,a=e.high-e.low;if(r/a<.6)return!1;let o=t.map(e=>e.low);return e.close<Math.min(...o)}countBrokenSwingPoints(e,t,i){let r=e[t],a=e.slice(0,t),o=0;if("bullish"===i)for(let e=1;e<a.length-1;e++){let t=a[e-1],i=a[e],s=a[e+1];i.high>t.high&&i.high>s.high&&r.close>i.high&&o++}else for(let e=1;e<a.length-1;e++){let t=a[e-1],i=a[e],s=a[e+1];i.low<t.low&&i.low<s.low&&r.close<i.low&&o++}return o}findImpulsiveMovement(e){let t=0,i="up";for(let r=5;r<e.length;r++){let a=Math.abs(e[r].close-e[r-5].close);a>t&&(t=a,i=e[r].close>e[r-5].close?"up":"down")}return{direction:i,strength:t}}identifyMonthlyZones(e){let t=[],i=[];for(let i=2;i<e.length-2;i++){let r=e[i-1],a=e[i],o=e[i+1];a.low<r.low&&a.low<o.low&&t.push({low:a.low,high:a.close,strength:1})}for(let t=2;t<e.length-2;t++){let r=e[t-1],a=e[t],o=e[t+1];a.high>r.high&&a.high>o.high&&i.push({low:a.open,high:a.high,strength:1})}return{buyZones:t,sellZones:i}}async findTradingSetups(e){let t=[],i=await this.determineMonthlyBias(e),r=await this.findValidFootprints(e,"4H",200);if(!this.brokerConfig)throw Error("Broker config not set");let a=await this.brokerAPIs.getCurrentPrice(this.brokerConfig,e);for(let o of r){let r=o.range;if(a>=r.floor&&a<=r.base){let s=await this.findEntrySignals(e,r,o.direction);if(s.length>0){let e=this.createTradingSetup(o,i,s,a);t.push(e)}}}return t}async findEntrySignals(e,t,i){let r=[],a=await this.brokerAPIs.getHistoricalData(e,"15m",100),o=this.findPinbarSignals(a,t,i);r.push(...o);let s=this.findEngulfingSignals(a,t,i);r.push(...s);let n=this.findFibonacciSignals(a,t,i);return r.push(...n),r}findPinbarSignals(e,t,i){let r=[];for(let a=1;a<e.length-1;a++){let o=e[a];if(o.low>=t.floor&&o.high<=t.base){let e=Math.abs(o.close-o.open),t=o.high-o.low;if((t-e)/t>.7&&"bullish"===i&&o.close>o.open){let t=Math.min(o.open,o.close)-o.low,i=o.high-Math.max(o.open,o.close);t>2*e&&i<e&&r.push({type:"pinbar",timeframe:"15m",timestamp:o.timestamp,price:o.low,strength:1,confirmation:!0})}}}return r}findEngulfingSignals(e,t,i){let r=[];for(let a=1;a<e.length;a++){let o=e[a],s=e[a-1];o.low>=t.floor&&o.high<=t.base&&s.low>=t.floor&&s.high<=t.base&&"bullish"===i&&o.close>o.open&&s.close<s.open&&o.open<s.close&&o.close>s.open&&r.push({type:"engulfing",timeframe:"15m",timestamp:o.timestamp,price:o.open,strength:1,confirmation:!0})}return r}findFibonacciSignals(e,t,i){let r=[],a=this.findABMovement(e,i);if(a){let{pointA:t,pointB:i}=a,o=this.calculateFibonacciLevels(t,i),s=e[e.length-1].close;Math.abs(s-o.fifty)/o.fifty<.01&&r.push({type:"fibonacci_retracement",timeframe:"15m",timestamp:Date.now(),price:s,strength:1,confirmation:!0}),Math.abs(s-o.sixtyOneEight)/o.sixtyOneEight<.01&&r.push({type:"fibonacci_retracement",timeframe:"15m",timestamp:Date.now(),price:s,strength:1,confirmation:!0})}return r}findABMovement(e,t){for(let i=10;i<e.length-5;i++){let r=e[i],a=e[i+5];if("bullish"===t&&a.close>r.close)return{pointA:r.low,pointB:a.high};if("bearish"===t&&a.close<r.close)return{pointA:r.high,pointB:a.low}}return null}calculateFibonacciLevels(e,t){let i=Math.abs(t-e);return{fifty:e+.5*i,sixtyOneEight:e+.618*i,seventyEightSix:e+.786*i}}createTradingSetup(e,t,i,r){let a=e.range,o=(a.floor+a.base)/2,s="bullish"===e.direction?a.floor-(a.base-a.floor)*.1:a.base+(a.base-a.floor)*.1,n=Math.abs(r-s),l=[r+3*n,r+4*n,r+5*n],c=l[0]-r/n;return{id:`setup_${e.id}_${Date.now()}`,instrument:e.instrument,footprint:e,monthlyBias:t.bias,weeklyBias:"potentially_reversing",entryRange:{floor:a.floor,base:a.base,midpoint:o},entrySignals:i,riskRewardRatio:c,stopLoss:s,targets:l,status:"waiting"}}async executeSetup(e,t){try{if(!this.brokerConfig)throw Error("Broker config not set");let i=await this.brokerAPIs.getCurrentPrice(this.brokerConfig,e.instrument);if(i<e.entryRange.floor||i>e.entryRange.base)return console.log("Setup no longer valid - price outside range"),!1;if((await this.brokerAPIs.placeOrder({instrument:e.instrument,side:"bullish"===e.footprint.direction?"buy":"sell",type:"market",quantity:t,stopLoss:e.stopLoss,takeProfit:e.targets[0]})).success)return e.status="active",this.activeSetups.set(e.id,e),console.log(`BFI setup executed: ${e.id}`),!0;return!1}catch(e){return console.error("Error executing BFI setup:",e),!1}}async monitorSetups(){for(let[e,t]of this.activeSetups){if(!this.brokerConfig)throw Error("Broker config not set");let i=await this.brokerAPIs.getCurrentPrice(this.brokerConfig,t.instrument);"bullish"===t.footprint.direction&&i<=t.stopLoss?await this.closeSetup(e,"stop_loss"):"bearish"===t.footprint.direction&&i>=t.stopLoss&&await this.closeSetup(e,"stop_loss");for(let r=0;r<t.targets.length;r++)if("bullish"===t.footprint.direction&&i>=t.targets[r]||"bearish"===t.footprint.direction&&i<=t.targets[r]){await this.closeSetup(e,"target_hit",r+1);break}}}async closeSetup(e,t,i){let r=this.activeSetups.get(e);if(r)try{if(!this.brokerConfig)throw Error("Broker config not set");await this.brokerAPIs.closePosition(this.brokerConfig,r.instrument),r.status="completed",console.log(`BFI setup closed: ${e} - ${t}${i?` (Target ${i})`:""}`),this.activeSetups.delete(e)}catch(e){console.error("Error closing BFI setup:",e)}}getActiveSetups(){return Array.from(this.activeSetups.values())}getMonthlyBias(e){return this.monthlyBiases.get(e)}}r()}catch(e){r(e)}})},8950:(e,t,i)=>{i.a(e,async(e,r)=>{try{i.d(t,{p:()=>n});var a=i(5322),o=e([a]);a=(o.then?(await o)():o)[0];class s{getExchange(e){let t={apiKey:e.apiKey,secret:e.secretKey,enableRateLimit:!0,options:{}};switch(e.baseUrl&&(t.urls={api:{rest:e.baseUrl}}),e.broker.toLowerCase()){case"binance":return new a.default.binance(t);case"coinbase":return new a.default.coinbase(t);case"kraken":return new a.default.kraken(t);case"kucoin":return new a.default.kucoin(t);case"okx":return new a.default.okx(t);default:throw Error(`Unsupported broker: ${e.broker}`)}}async testConnection(e){try{let t=this.getExchange(e);return await t.fetchBalance(),!0}catch(e){return console.error("Connection test failed:",e),!1}}async getBalance(e){try{let t=this.getExchange(e),i=await t.fetchBalance();return Object.entries(i).map(([e,t])=>({currency:e,free:t.free||0,used:t.used||0,total:t.total||0})).filter(e=>e.total>0)}catch(e){throw console.error("Failed to fetch balance:",e),Error("Failed to fetch account balance")}}async getTicker(e,t){try{let i=this.getExchange(e),r=await i.fetchTicker(t);return{symbol:r.symbol,price:r.last,change24h:r.change,changePercent24h:r.percentage,volume24h:r.baseVolume,high24h:r.high,low24h:r.low}}catch(e){throw console.error("Failed to fetch ticker:",e),Error("Failed to fetch price data")}}async placeOrder(e,t){try{let i=this.getExchange(e),r={symbol:t.symbol,type:t.type,side:t.side,amount:t.amount};"limit"===t.type&&t.price&&(r.price=t.price);let a=await i.createOrder(r.symbol,r.type,r.side,r.amount,r.price);return{orderId:a.id,symbol:a.symbol,side:a.side,type:a.type,amount:a.amount,price:a.price,status:a.status,timestamp:a.timestamp}}catch(e){throw console.error("Failed to place order:",e),Error("Failed to place order")}}async getOrderHistory(e,t,i=100){try{let r=this.getExchange(e);return(await r.fetchMyTrades(t,void 0,i)).map(e=>({id:e.id,symbol:e.symbol,side:e.side,amount:e.amount,price:e.price,cost:e.cost,fee:e.fee?.cost||0,timestamp:e.timestamp}))}catch(e){throw console.error("Failed to fetch trade history:",e),Error("Failed to fetch trade history")}}async getOpenOrders(e,t){try{let i=this.getExchange(e);return(await i.fetchOpenOrders(t)).map(e=>({id:e.id,symbol:e.symbol,side:e.side,type:e.type,amount:e.amount,price:e.price,filled:e.filled,remaining:e.remaining,status:e.status,timestamp:e.timestamp}))}catch(e){throw console.error("Failed to fetch open orders:",e),Error("Failed to fetch open orders")}}async cancelOrder(e,t,i){try{let r=this.getExchange(e),a=await r.cancelOrder(t,i);return{orderId:a.id,status:a.status,timestamp:a.timestamp}}catch(e){throw console.error("Failed to cancel order:",e),Error("Failed to cancel order")}}async getMarkets(e){try{let t=this.getExchange(e),i=await t.loadMarkets();return Object.values(i).map(e=>({symbol:e.symbol,base:e.base,quote:e.quote,active:e.active,precision:e.precision,limits:e.limits}))}catch(e){throw console.error("Failed to fetch markets:",e),Error("Failed to fetch markets")}}async getHistoricalData(e,t,i,r=100){try{let a=this.getExchange(e);return(await a.fetchOHLCV(t,i,void 0,r)).map(e=>({timestamp:e[0],open:e[1],high:e[2],low:e[3],close:e[4],volume:e[5]}))}catch(e){throw console.error("Failed to fetch historical data:",e),Error("Failed to fetch historical data")}}async getCurrentPrice(e,t){let i=await this.getTicker(e,t);if("number"!=typeof i.price)throw Error("Price data unavailable");return i.price}}let n=new s;r()}catch(e){r(e)}})},5583:(e,t,i)=>{i.d(t,{X:()=>a});var r=i(7943);class a{constructor(e){this.data=e}calculateAllIndicators(){return{rsi:this.calculateRSI(),macd:this.calculateMACD(),bollinger:this.calculateBollingerBands(),sma20:this.calculateSMA(20),sma50:this.calculateSMA(50),ema12:this.calculateEMA(12),ema26:this.calculateEMA(26),stochastic:this.calculateStochastic()}}calculateRSI(e=14){return r.RSI.calculate({values:this.data.close,period:e})}calculateMACD(){let e=r.MACD.calculate({values:this.data.close,fastPeriod:12,slowPeriod:26,signalPeriod:9});return{MACD:e.map(e=>e.MACD),signal:e.map(e=>e.signal),histogram:e.map(e=>e.histogram)}}calculateBollingerBands(e=20,t=2){let i=r.BollingerBands.calculate({values:this.data.close,period:e,stdDev:t});return{upper:i.map(e=>e.upper),middle:i.map(e=>e.middle),lower:i.map(e=>e.lower)}}calculateSMA(e){return r.SMA.calculate({values:this.data.close,period:e})}calculateEMA(e){return r.EMA.calculate({values:this.data.close,period:e})}calculateStochastic(e=14){let t=r.Stochastic.calculate({high:this.data.high,low:this.data.low,close:this.data.close,period:e,signalPeriod:3});return{k:t.map(e=>e.k),d:t.map(e=>e.d)}}generateTradingSignal(e,t){let i=this.calculateAllIndicators(),r=i.rsi.length-1;if(r<0)return{action:"HOLD",strength:0,indicators:{rsi:{value:0,signal:"N/A"},macd:{signal:"N/A",histogram:0},bollinger:{position:"N/A",bandwidth:0},movingAverages:{signal:"N/A"},stochastic:{signal:"N/A"}},confidence:0,reason:"Insufficient data"};let a=this.data.close[r],o=i.rsi[r],s=i.macd.histogram[r],n=i.bollinger.upper[r],l=i.bollinger.lower[r],c=i.sma20[r],h=i.sma50[r],u=i.stochastic.k[r],g=this.analyzeRSI(o,t.rsi?.oversold||30,t.rsi?.overbought||70),p=this.analyzeMACD(s,i.macd.MACD[r],i.macd.signal[r]),d=this.analyzeBollingerBands(a,n,l),m=this.analyzeMovingAverages(c,h,a),f=this.analyzeStochastic(u,i.stochastic.d[r]),b="HOLD",y=0,w=0,v="";switch(e){case"RSI":b=g.action,w=Math.min(y=2*Math.abs(o-50),100),v=g.reason;break;case"MACD":b=p.action,w=Math.min(y=100*Math.abs(s),100),v=p.reason;break;case"BOLLINGER":b=d.action,w=Math.min(y=d.strength,100),v=d.reason;break;case"CUSTOM":let S=[g,p,d,m,f],k=S.filter(e=>"BUY"===e.action).length,A=S.filter(e=>"SELL"===e.action).length;k>=3?(b="BUY",y=k/S.length*100,v=`Multiple indicators showing buy signal (${k}/${S.length})`):A>=3?(b="SELL",y=A/S.length*100,v=`Multiple indicators showing sell signal (${A}/${S.length})`):(b="HOLD",y=0,v="Mixed signals, holding position"),w=y;break;default:b="HOLD",y=0,w=0,v="Unknown strategy type"}return{action:b,strength:y,indicators:{rsi:{value:o,signal:g.reason},macd:{signal:p.reason,histogram:s},bollinger:{position:d.reason,bandwidth:(n-l)/a},movingAverages:{signal:m.reason},stochastic:{signal:f.reason}},confidence:w,reason:v}}analyzeRSI(e,t,i){return e<t?{action:"BUY",reason:`RSI oversold (${e.toFixed(2)})`}:e>i?{action:"SELL",reason:`RSI overbought (${e.toFixed(2)})`}:{action:"HOLD",reason:`RSI neutral (${e.toFixed(2)})`}}analyzeMACD(e,t,i){return e>0&&t>i?{action:"BUY",reason:"MACD bullish crossover"}:e<0&&t<i?{action:"SELL",reason:"MACD bearish crossover"}:{action:"HOLD",reason:"MACD neutral"}}analyzeBollingerBands(e,t,i){let r=(e-i)/(t-i);return e<=i?{action:"BUY",strength:100,reason:"Price at lower Bollinger Band"}:e>=t?{action:"SELL",strength:100,reason:"Price at upper Bollinger Band"}:r<.2?{action:"BUY",strength:80,reason:"Price near lower Bollinger Band"}:r>.8?{action:"SELL",strength:80,reason:"Price near upper Bollinger Band"}:{action:"HOLD",strength:0,reason:"Price within Bollinger Bands"}}analyzeMovingAverages(e,t,i){return e>t&&i>e?{action:"BUY",reason:"Price above moving averages (bullish)"}:e<t&&i<e?{action:"SELL",reason:"Price below moving averages (bearish)"}:{action:"HOLD",reason:"Moving averages neutral"}}analyzeStochastic(e,t){return e<20&&t<20?{action:"BUY",reason:"Stochastic oversold"}:e>80&&t>80?{action:"SELL",reason:"Stochastic overbought"}:{action:"HOLD",reason:"Stochastic neutral"}}}},7153:(e,t)=>{var i;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return i}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(i||(i={}))},1802:(e,t,i)=>{e.exports=i(145)}};